import{r as n,j as e,L as A,R as L,i as T,k as $,G as w,B as R,h as I,A as O,s as F}from"./index-CCGi1RQB.js";import{s as D}from"./RecipeNutrition.module-CY2PGmtn.js";const K="_Recipe_u125c_2",V="_recipe_replace_back_u125c_7",G="_page_title_u125c_26",H="_search_form_u125c_59",U="_search_input_area_u125c_67",X="_search_sortby_area_u125c_97",B="_checkbox_item_u125c_105",W="_search_result_container_u125c_112",q="_recipe_main_item_con_u125c_133",z="_appear_u125c_1",Q="_recipe_main_item_u125c_133",Y="_recipe_main_title_u125c_178",J="_recipe_main_category_u125c_183",Z="_undefined_meg_u125c_192",ee="_loading_spinner_u125c_198",te="_message_container_u125c_207",se="_message_u125c_207",a={Recipe:K,recipe_replace_back:V,page_title:G,search_form:H,search_input_area:U,search_sortby_area:X,checkbox_item:B,search_result_container:W,recipe_main_item_con:q,appear:z,recipe_main_item:Q,recipe_main_title:Y,recipe_main_category:J,undefined_meg:Z,loading_spinner:ee,message_container:te,message:se};function ne({setCheckedMenu:t,setUserInputValue:r,getRecipeDataFromApi:c,userInputValue:o,checkedMenu:l,categories:u}){const _=n.useRef(null);n.useEffect(()=>{_.current&&_.current.focus()},[]);function d(s){c(s,l),sessionStorage.setItem("currentRecipes","0")}return e.jsxs("article",{className:a.search_form,children:[e.jsxs("div",{className:a.search_input_area,children:[e.jsx("label",{htmlFor:"recipe_search"}),e.jsx("input",{placeholder:"ex) 스파게티",ref:_,id:"recipe_search",type:"search",onKeyDown:s=>{const i=s.currentTarget.value;r(i),s.key==="Enter"&&d(o)}}),e.jsx("button",{onClick:s=>{var f;const h=((f=s.currentTarget.parentElement)==null?void 0:f.children)[1].value;d(h)},children:"검색"})]}),e.jsx("div",{className:a.search_sortby_area,children:u.map(s=>e.jsxs("p",{className:a.checkbox_item,children:[e.jsx("input",{name:"category",onClick:i=>{t(i.currentTarget.value)},type:"radio",value:`${s}`}),s===""?"전체":s]},s))})]})}function ce({recipes:t,visibleRecipes:r}){const[c,o]=n.useState(!0);return e.jsxs("article",{className:a.message_container,style:c?{maxWidth:"240px",maxHeight:"40px"}:{maxWidth:"30px",maxHeight:"40px"},children:[e.jsx("button",{style:c?{transform:"rotate(-180deg)"}:{transform:"rotate(0)"},onClick:()=>{o(!c)},children:"←"}),e.jsxs("span",{className:a.message,style:c?{visibility:"visible",opacity:1,transform:"translateX(0)"}:{visibility:"hidden",opacity:0,transform:"translateX(5px)"},children:[t==null?void 0:t.length,"개 중 ",r==null?void 0:r.length," 포스트 조회.."]})]})}function ae({recipe:t}){const{RCP_SEQ:r,RCP_NA_TIP:c,ATT_FILE_NO_MAIN:o,RCP_NM:l,RCP_PAT2:u}=t;return e.jsx(A,{to:`/recipe/${r}`,children:e.jsx("ul",{className:a.recipe_main_item_con,style:{backgroundImage:`url(${o||"/not-image.png"})`,backgroundPosition:"ceter",backgroundSize:"cover"},children:e.jsxs("li",{className:a.recipe_main_item,children:[e.jsx("h3",{children:r}),e.jsx("h3",{className:a.recipe_main_title,children:l}),e.jsx("p",{className:a.recipe_main_category,children:u})]})})},c)}function re({recipes:t,meg:r}){const[c,o]=n.useState([]),[l,u]=n.useState(0),_=n.useRef(null),d=t?t.length:0;return n.useEffect(()=>{t&&o(t.slice(0,10))},[t]),n.useEffect(()=>{u(l)},[l]),n.useEffect(()=>{const s=_.current,i=()=>{if(s&&s.getBoundingClientRect().bottom<=window.innerHeight+100){const m=Number(sessionStorage.getItem("currentRecipes"));u(m);const h=t==null?void 0:t.slice(m,m+10);h&&h.length>0&&o(x=>[...x,...h])}};return window.addEventListener("scroll",i),sessionStorage.setItem("currentRecipes",`${c.length}`),()=>{window.removeEventListener("scroll",i)}},[t,c,l]),e.jsxs(e.Fragment,{children:[d<1&&e.jsx("div",{className:a.recipe_replace_back}),e.jsx("h3",{className:a.undefined_meg,children:r}),e.jsxs("article",{ref:_,className:a.search_result_container,children:[c.map(s=>e.jsx(ae,{recipe:s},s.RCP_NM)),e.jsx("br",{})]}),e.jsx(ce,{recipes:t,visibleRecipes:c})]})}function ie({loading:t}){return e.jsx("div",{className:D.loading_spinner,style:t?{display:"inline-block"}:{display:"none"},children:t&&e.jsx(L,{})})}const N="c316cbfadf8c4642b8bb";function le(){const[t,r]=n.useState(""),[c]=n.useState(["","후식","국","반찬","밥","일품","기타"]),[o,l]=n.useState(""),[u,_]=n.useState(""),[d,s]=n.useState(!1),[i,m]=n.useState(),h=n.useRef(null),f=T(),x=$(p=>p.recipe);n.useEffect(()=>{document.title="레시피 정보조회 | FoodPicker"},[]),n.useEffect(()=>{m(x.value)},[x.value]);function C(p){const g=p.COOKRCP01.row;g?(m(g),_(""),f(F(g)),R.success("상품조회에 성공하였습니다.")):(_(p.COOKRCP01.RESULT.MSG),R.error("조회된 상품이 존재하지 않습니다.")),s(!1)}const k=async(p="",g="")=>{s(!0);const j=p.length,y=g.length,E=j===0&&y>=0,P=y===0&&j>=1,v=j>=1&&y>0;if(E){s(!1),_("검색어를 입력해주세요."),R.warn("검색어를 입력해주세요.");return}const M=P?`https://openapi.foodsafetykorea.go.kr/api/${N}/COOKRCP01/json/1/200/RCP_NM=${p}`:v?`https://openapi.foodsafetykorea.go.kr/api/${N}/COOKRCP01/json/1/200/RCP_NM=${p}&RCP_PAT2=${g}`:null,b=await I(M,O.EXTERNAL);return b?C(b):R.error("데이터 요청에 실패하였습니다.")},S=(i==null?void 0:i.length)||0;return e.jsxs("section",{className:a.Recipe,ref:h,children:[e.jsx("h2",{className:a.page_title,children:"음식 레시피"}),e.jsx(w,{path:"/recipe",mainName:"조회서비스",subName:"음식레시피",totalCount:S}),e.jsx(ne,{setCheckedMenu:l,setUserInputValue:r,getRecipeDataFromApi:k,userInputValue:t,checkedMenu:o,categories:c}),e.jsx(ie,{loading:d}),e.jsx(re,{recipes:i,meg:u})]})}export{le as default};
